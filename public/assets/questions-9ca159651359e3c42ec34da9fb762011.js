/*!
 * Rails 3 Client Side Validations - v3.1.4
 * https://github.com/bcardarlela/client_side_validations
 *
 * Copyright (c) 2011 Brian Cardarella
 * Licensed under the MIT license
 * http://www.opensource.org/licenses/mit-license.php
 */
(function(e){e.fn.validate=function(){return this.filter("form[data-validate]").each(function(){var t=e(this),n=window[t.attr("id")];t.submit(function(){return t.isValid(n.validators)}).bind("ajax:beforeSend",function(e){if(e.target==this)return t.isValid(n.validators)}).bind("form:validate:after",function(e){clientSideValidations.callbacks.form.after(t,e)}).bind("form:validate:before",function(e){clientSideValidations.callbacks.form.before(t,e)}).bind("form:validate:fail",function(e){clientSideValidations.callbacks.form.fail(t,e)}).bind("form:validate:pass",function(e){clientSideValidations.callbacks.form.pass(t,e)}).find("[data-validate]:input:not(:radio)").live("focusout",function(){e(this).isValid(n.validators)}).live("change",function(){e(this).data("changed",!0)}).live("element:validate:after",function(t){clientSideValidations.callbacks.element.after(e(this),t)}).live("element:validate:before",function(t){clientSideValidations.callbacks.element.before(e(this),t)}).live("element:validate:fail",function(t,n){var i=e(this);clientSideValidations.callbacks.element.fail(i,n,function(){r(i,n)},t)}).live("element:validate:pass",function(t){var n=e(this);clientSideValidations.callbacks.element.pass(n,function(){i(n)},t)}).end().find("[data-validate]:checkbox").live("click",function(){e(this).isValid(n.validators)}).end().find("[id*=_confirmation]").each(function(){var r=e(this),i=t.find("#"+this.id.match(/(.+)_confirmation/)[1]+"[data-validate]:input");i[0]&&e("#"+r.attr("id")).live("focusout",function(){i.data("changed",!0).isValid(n.validators)}).live("keyup",function(){i.data("changed",!0).isValid(n.validators)})});var r=function(e,t){clientSideValidations.formBuilders[n.type].add(e,n,t)},i=function(e){clientSideValidations.formBuilders[n.type].remove(e,n)}})},e.fn.isValid=function(r){return e(this[0]).is("form")?t(e(this[0]),r):n(e(this[0]),r[this[0].name])};var t=function(t,n){var r=!0;return t.trigger("form:validate:before").find("[data-validate]:input").each(function(){e(this).isValid(n)||(r=!1)}),r?t.trigger("form:validate:pass"):t.trigger("form:validate:fail"),t.trigger("form:validate:after"),r},n=function(e,t){e.trigger("element:validate:before");if(e.data("changed")!==!1){var n=!0;e.data("changed",!1);for(kind in clientSideValidations.validators.all())if(t[kind]&&(message=clientSideValidations.validators.all()[kind](e,t[kind]))){e.trigger("element:validate:fail",message).data("valid",!1),n=!1;break}n&&(e.data("valid",null),e.trigger("element:validate:pass"))}return e.trigger("element:validate:after"),e.data("valid")===!1?!1:!0};e(function(){e("form[data-validate]").validate()})})(jQuery);var clientSideValidations={validators:{all:function(){return jQuery.extend({},clientSideValidations.validators.local,clientSideValidations.validators.remote)},local:{presence:function(e,t){if(/^\s*$/.test(e.val()||""))return t.message},acceptance:function(e,t){switch(e.attr("type")){case"checkbox":if(!e.attr("checked"))return t.message;break;case"text":if(e.val()!=(t.accept||"1"))return t.message}},format:function(e,t){if((message=this.presence(e,t))&&t.allow_blank==1)return;if(message)return message;if(t["with"]&&!t["with"].test(e.val()))return t.message;if(t.without&&t.without.test(e.val()))return t.message},numericality:function(e,t){if(!/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d*)?$/.test(e.val())&&e.val()!="")return t.messages.numericality;if(t.only_integer&&!/^[+-]?\d+$/.test(e.val()))return t.messages.only_integer;var n={greater_than:">",greater_than_or_equal_to:">=",equal_to:"==",less_than:"<",less_than_or_equal_to:"<="};for(var r in n)if(t[r]!=undefined&&!(new Function("return "+e.val()+n[r]+t[r]))())return t.messages[r];if(t.odd&&!(parseInt(e.val())%2))return t.messages.odd;if(t.even&&parseInt(e.val())%2)return t.messages.even},length:function(e,t){var n={};t.is?n.message=t.messages.is:t.minimum&&(n.message=t.messages.minimum);if((message=this.presence(e,n))&&t.allow_blank==1)return;if(message)return message;var r={is:"==",minimum:">=",maximum:"<="},i=t.js_tokenizer||"split('')",s=(new Function("element","return (element.val()."+i+" || '').length;"))(e);for(var o in r)if(t[o]&&!(new Function("return "+s+r[o]+t[o]))())return t.messages[o]},exclusion:function(e,t){if((message=this.presence(e,t))&&t.allow_blank==1)return;if(message)return message;if(t["in"]){for(var n=0;n<t["in"].length;n++)if(t["in"][n]==e.val())return t.message}else if(t.range){var r=t.range[0],i=t.range[1];if(e.val()>=r&&e.val()<=i)return t.message}},inclusion:function(e,t){if((message=this.presence(e,t))&&t.allow_blank==1)return;if(message)return message;if(t["in"]){for(var n=0;n<t["in"].length;n++)if(t["in"][n]==e.val())return;return t.message}if(t.range){var r=t.range[0],i=t.range[1];if(e.val()>=r&&e.val()<=i)return;return t.message}},confirmation:function(e,t){if(e.val()!=jQuery("#"+e.attr("id")+"_confirmation").val())return t.message}},remote:{uniqueness:function(e,t){if((message=clientSideValidations.validators.local.presence(e,t))&&t.allow_blank===!0)return;if(message)return message;var n={};n.case_sensitive=!!t.case_sensitive,t.id&&(n.id=t.id);if(t.scope){n.scope={};for(key in t.scope){var r=jQuery('[name="'+e.attr("name").replace(/\[\w+]$/,"["+key+"]"+'"]'));r[0]&&r.val()!=t.scope[key]?(n.scope[key]=r.val(),r.unbind("change."+e.id).bind("change."+e.id,function(){e.trigger("change"),e.trigger("focusout")})):n.scope[key]=t.scope[key]}}if(/_attributes]/.test(e.attr("name"))){var i=e.attr("name").match(/\[\w+_attributes]/g).pop().match(/\[(\w+)_attributes]/).pop();i+=/(\[\w+])$/.exec(e.attr("name"))[1]}else var i=e.attr("name");t["class"]&&(i=t["class"]+"["+i.split("[")[1]),n[i]=e.val();if(jQuery.ajax({url:"/validators/uniqueness",data:n,async:false}).status==200)return t.message}}},formBuilders:{"ActionView::Helpers::FormBuilder":{add:function(e,t,n){if(e.data("valid")!==!1&&jQuery('label.message[for="'+e.attr("id")+'"]')[0]==undefined){var r=jQuery(t.input_tag),i=jQuery(t.label_tag),s=jQuery('label[for="'+e.attr("id")+'"]:not(.message)');e.attr("autofocus")&&e.attr("autofocus",!1),e.before(r),r.find("span#input_tag").replaceWith(e),r.find("label.message").attr("for",e.attr("id")),i.find("label.message").attr("for",e.attr("id")),s.replaceWith(i),i.find("label#label_tag").replaceWith(s)}jQuery('label.message[for="'+e.attr("id")+'"]').text(n)},remove:function(e,t){var n=jQuery(t.input_tag).attr("class"),r=e.closest("."+n),i=jQuery('label[for="'+e.attr("id")+'"]:not(.message)'),s=i.closest("."+n);r[0]&&(r.find("#"+e.attr("id")).detach(),r.replaceWith(e),i.detach(),s.replaceWith(i))}},"SimpleForm::FormBuilder":{add:function(e,t,n){if(e.data("valid")!==!1){var r=e.closest(t.wrapper_tag);r.addClass(t.wrapper_error_class);var i=$("<"+t.error_tag+' class="'+t.error_class+'">'+n+"</"+t.error_tag+">");r.append(i)}else e.parent().find(t.error_tag+"."+t.error_class).text(n)},remove:function(e,t){var n=e.closest(t.wrapper_tag+"."+t.wrapper_error_class);n.removeClass(t.wrapper_error_class);var r=n.find(t.error_tag+"."+t.error_class);r.remove()}},"Formtastic::FormBuilder":{add:function(e,t,n){if(e.data("valid")!==!1){var r=e.closest("li");r.addClass("error");var i=$('<p class="'+t.inline_error_class+'">'+n+"</p>");r.append(i)}else e.parent().find("p."+t.inline_error_class).text(n)},remove:function(e,t){var n=e.closest("li.error");n.removeClass("error");var r=n.find("p."+t.inline_error_class);r.remove()}},"NestedForm::Builder":{add:function(e,t,n){clientSideValidations.formBuilders["ActionView::Helpers::FormBuilder"].add(e,t,n)},remove:function(e,t,n){clientSideValidations.formBuilders["ActionView::Helpers::FormBuilder"].remove(e,t,n)}}},callbacks:{element:{after:function(e,t){},before:function(e,t){},fail:function(e,t,n,r){n()},pass:function(e,t,n){t()}},form:{after:function(e,t){},before:function(e,t){},fail:function(e,t){},pass:function(e,t){}}}};